<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Daily Holiday</title>
  <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTiwyHCThnIPlBmTh5QQjJlhrOpEpfDykiM1Q&s" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />

  <style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;scroll-behavior:smooth;}
    body.modal-open {overflow:hidden;}

    header {
      position:fixed;top:0;left:0;width:100%;
      background:white;box-shadow:0 2px 10px rgba(0,0,0,0.1);
      z-index:1000;display:flex;align-items:center;justify-content:space-between;
      padding:10px 40px;
    }
    header img {height:50px;margin-right:10px;border-radius:50%;}
    header h1 {font-family:"Pacifico",cursive;font-size:28px;color:#0078ff;font-weight:400;}
    nav ul {list-style:none;display:flex;gap:20px;}
    nav ul li a {text-decoration:none;color:#0078ff;font-weight:500;transition:.3s;}
    nav ul li a:hover {color:#005ed6;}
    .menu-toggle {display:none;font-size:26px;color:#0078ff;cursor:pointer;}
    @media(max-width:768px){
      .menu-toggle{display:block;margin-left:auto;}
      nav ul{display:none;position:absolute;top:70px;right:0;background:white;flex-direction:column;width:100%;text-align:center;padding:20px 0;}
      nav ul.show{display:flex;}
    }

    section{padding:100px 10%;}
    #home {
      height:100vh;background:url("https://images.unsplash.com/photo-1507525428034-b723cf961d3e") center/cover no-repeat;
      color:white;display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;
    }
    #home img {width:200px;border-radius:50%;margin-bottom:20px;}
    #home p {font-size:1.3rem;letter-spacing:1px;text-shadow:0 2px 6px rgba(0,0,0,0.5);}
    #about,#destinations,#domestic,#instagram,#joinus{padding-top:120px;}

    /* === ARTICLE SECTION === */
    #articles {padding:60px 8%;background:#fff;text-align:center;}
    #articles h2 {color:#0078FF;margin-bottom:24px;font-size:34px;}
    #articles-list {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
      gap:20px;
      justify-content:center;
      align-items:start;
      max-width:1100px;
      margin:0 auto;
    }
    .article-card {
      background:#fff;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06);
      overflow:hidden;display:flex;flex-direction:column;text-align:left;
      transition:transform .3s ease;
    }
    .article-card:hover {transform:translateY(-5px);}
    .article-card img {width:100%;height:200px;object-fit:cover;}
    .article-card h4 {color:#0078FF;font-size:18px;margin:8px 0;}
    .article-card .article-summary {color:#333;font-size:14px;}
    #loadMoreBtn {
      background:#0078FF;color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;margin-top:26px;
    }

    /* === MODAL === */
    #articleModal {
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;
      background:rgba(0,0,0,0.5);z-index:2000;padding:20px;overflow:hidden;
    }
    #articleModal .modal-content {
      background:#fff;border-radius:12px;overflow:hidden;display:flex;flex-direction:row;
      width:90%;max-width:1000px;max-height:90vh;box-shadow:0 8px 28px rgba(0,0,0,0.25);
    }
    #modalImageWrap {flex:0 0 40%;background:#fff;}
    #modalImageWrap img {width:100%;height:100%;object-fit:cover;}
    .article-modal-content {
      flex:0 0 60%;display:flex;flex-direction:column;overflow:hidden;padding:24px;
    }
    .article-modal-header {
      position:sticky;top:0;background:#fff;z-index:10;border-bottom:1px solid #eee;padding-bottom:8px;
    }
    .article-modal-header h2 {margin:0;font-size:20px;color:#0078ff;}
    #closeModal {float:right;background:none;border:none;font-size:26px;color:#333;cursor:pointer;}
    .article-modal-body {
      flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-top:10px;color:#333;font-size:15px;line-height:1.6;
    }
    @media(max-width:768px){
      #articleModal{align-items:flex-start;}
      #articleModal .modal-content{flex-direction:column;width:95%;max-height:90vh;}
      #modalImageWrap{flex:none;max-height:40vh;}
      .article-modal-content{flex:none;max-height:50vh;padding:20px;}
      .article-modal-body{max-height:100%;overflow-y:auto;}
    }
  </style>
</head>

<body id="top">
  <!-- Header -->
  <header>
    <div style="display:flex;align-items:center">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTiwyHCThnIPlBmTh5QQjJlhrOpEpfDykiM1Q&s" alt="Daily Holiday Logo" />
      <h1 style="font-style:italic;">Daily Holiday</h1>
    </div>
    <div class="menu-toggle" id="menu-toggle"><i class="fa-solid fa-bars"></i></div>
    <nav>
      <ul id="menu">
        <li><a href="#top">Home</a></li>
        <li><a href="#articles">Articles</a></li>
        <li><a href="#destinations">International</a></li>
        <li><a href="#domestic">Domestic</a></li>
        <li><a href="#instagram">Promo</a></li>
        <li><a href="#about">About Us</a></li>
        <li><a href="#joinus">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- Hero -->
  <section id="home">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTiwyHCThnIPlBmTh5QQjJlhrOpEpfDykiM1Q&s" />
    <p>YOUR EVERYDAY PARTNER ✈️</p>
  </section>

  <!-- Articles -->
  <section id="articles">
    <h2>Latest Travel Articles</h2>
    <div id="articles-list"></div>
    <button id="loadMoreBtn">Load more</button>
    <p id="noMoreMsg" style="display:none;color:#666;">No more articles.</p>
  </section>

  <!-- Modal -->
  <div id="articleModal">
    <div class="modal-content">
      <div id="modalImageWrap"><img id="modalImage" src="" alt="Article Image"></div>
      <div class="article-modal-content">
        <div class="article-modal-header">
          <button id="closeModal">×</button>
          <h2 id="modalTitle"></h2>
        </div>
        <div class="article-modal-body" id="modalBody"></div>
      </div>
    </div>
  </div>

  <!-- Firebase Scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import { getFirestore, collection, query, orderBy, limit, getDocs, startAfter } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey:"AIzaSyBS7C50eMiRtQ4nge4HrXo0ZuEkKoIVIUE",
      authDomain:"daily-holiday.firebaseapp.com",
      projectId:"daily-holiday",
      storageBucket:"daily-holiday.firebasestorage.app",
      messagingSenderId:"51054604621",
      appId:"1:51054604621:web:deffcd35458bb7c6b18704",
      measurementId:"G-SX1PV7VLSX"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const ARTICLES_PER_PAGE = 3;
    const articlesListEl = document.getElementById("articles-list");
    const loadMoreBtn = document.getElementById("loadMoreBtn");
    const noMoreMsg = document.getElementById("noMoreMsg");

    let lastVisibleDoc = null;
    let finished = false;

    function normalizeImageURL(url) {
      if (!url) return url;
      const patterns=[/\/file\/d\/([a-zA-Z0-9_-]+)/,/\/d\/([a-zA-Z0-9_-]+)/,/[\?&]id=([a-zA-Z0-9_-]+)/];
      for(const re of patterns){const m=url.match(re);if(m)return`https://drive.google.com/uc?export=view&id=${m[1]}`;}
      return url;
    }

    function truncateSummary(text,maxChars=80,id=""){if(!text)return"";if(text.length<=maxChars)return text;
      return text.slice(0,maxChars)+"... <a href='#' class='read-more' data-id='"+id+"'>Read More</a>";
    }

    function renderArticleCard(doc){
      const d=doc.data();const id=doc.id;
      const div=document.createElement("div");div.className="article-card";
      div.innerHTML=`
        <img src="${normalizeImageURL(d.imageURL||'')}" alt="${d.title||'Untitled'}"/>
        <div style="padding:14px;">
          <h4>${d.title||'Untitled'}</h4>
          <div class="article-summary">${truncateSummary(d.summary||'',80,id)}</div>
        </div>`;
      div.addEventListener("click",()=>openModalWithDoc(doc));
      return div;
    }

    async function loadArticles(){
      if(finished)return;
      loadMoreBtn.disabled=true;loadMoreBtn.textContent="Loading...";
      const ref=collection(db,"articles");
      const q=!lastVisibleDoc?query(ref,orderBy("createdAt","desc"),limit(ARTICLES_PER_PAGE))
                             :query(ref,orderBy("createdAt","desc"),startAfter(lastVisibleDoc),limit(ARTICLES_PER_PAGE));
      const snap=await getDocs(q);
      if(snap.empty){finished=true;loadMoreBtn.style.display="none";noMoreMsg.style.display="block";return;}
      snap.forEach(doc=>articlesListEl.appendChild(renderArticleCard(doc)));
      lastVisibleDoc=snap.docs[snap.docs.length-1];
      if(snap.docs.length<ARTICLES_PER_PAGE){finished=true;loadMoreBtn.style.display="none";noMoreMsg.style.display="block";}
      loadMoreBtn.disabled=false;loadMoreBtn.textContent="Load more";
    }

    function openModalWithDoc(doc){
      const d=doc.data();
      document.getElementById("modalTitle").textContent=d.title||"Untitled";
      document.getElementById("modalBody").innerHTML=d.content||d.summary||"";
      const img=document.getElementById("modalImage");
      img.src=normalizeImageURL(d.imageURL||"");
      document.getElementById("articleModal").style.display="flex";
      document.body.classList.add("modal-open");
      document.getElementById("modalBody").scrollTop=0;
    }

    function closeModal(){
      document.getElementById("articleModal").style.display="none";
      document.body.classList.remove("modal-open");
    }
    document.getElementById("closeModal").addEventListener("click",closeModal);
    document.getElementById("articleModal").addEventListener("click",e=>{if(e.target.id==="articleModal")closeModal();});

    loadArticles();
    loadMoreBtn.addEventListener("click",loadArticles);
  </script>

  <script>
    const toggle=document.getElementById("menu-toggle");
    const menu=document.getElementById("menu");
    toggle.addEventListener("click",()=>menu.classList.toggle("show"));
    document.querySelectorAll("#menu a").forEach(a=>a.addEventListener("click",()=>menu.classList.remove("show")));
  </script>
</body>
</html>
